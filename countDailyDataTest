function countDailyData() {
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  
  // Get the sheets
  var sourceSheet = ss.getSheetByName('3/27/2025-Present');
  var dailyCountSheet = ss.getSheetByName('Daily Count');
  
  // Get the date from B1 in Daily Count sheet
  var targetDate = dailyCountSheet.getRange('B1').getValue();
  
  // Format the date to match the source sheet format
  var formattedDate = Utilities.formatDate(targetDate, Session.getScriptTimeZone(), 'M/d/yyyy');
  
  // Get all data from source sheet
  var sourceData = sourceSheet.getDataRange().getValues();
  
  // Define the column indexes (0-based) in the NEW ORDER
  var dateCol = 0; // Column A
  var columnsToCount = {
    // Title - East Products (we'll skip this in output)
    'East Mobility MRR': 25, // Column Z
    'East SHS MRR': 24, // Column Y
    'Koodo Internet (put 1 if a sale)': 30, // Column AE
    'Koodo TV (put 1 if a sale)': 31, // Column AF
    'East TOS MRR': 26, // Column AA
    'East LWC MRR': 27, // Column AB
    'Altima TV (put 1 if a sale)': 28, // Column AC
    'Altima Internet (put 1 if a sale)': 29, // Column AD
    
    // Title - West Products (we'll skip this in output)
    'West Mob MRR': 33, // Column AH
    'West SHS MRR': 32, // Column AG
    'West HSIA MRR': 34, // Column AI
    'West Optik TV MRR': 35, // Column AJ
    'West Stream Plus': 36, // Column AK
    'West HP MRR': 37, // Column AL
    'West TOS': 38, // Column AM
    'West LWC MRR': 39, // Column AN
    'Smart Energy MRR': 40, // Column AO
    'Pure Fiber Internet MRR': 41  // Column AP
  };
  
  // Define the output order (excluding titles)
  var outputOrder = [
    'East Mobility MRR',
    'East SHS MRR', 
    'Koodo Internet (put 1 if a sale)',
    'Koodo TV (put 1 if a sale)',
    'East TOS MRR',
    'East LWC MRR',
    'Altima TV (put 1 if a sale)',
    'Altima Internet (put 1 if a sale)',
    'West Mob MRR',
    'West SHS MRR',
    'West HSIA MRR',
    'West Optik TV MRR',
    'West Stream Plus',
    'West HP MRR',
    'West TOS',
    'West LWC MRR',
    'Smart Energy MRR',
    'Pure Fiber Internet MRR'
  ];
  
  // Initialize counters
  var counts = {};
  outputOrder.forEach(function(key) {
    counts[key] = 0;
  });
  
  // Loop through all rows in source data
  for (var i = 1; i < sourceData.length; i++) { // Start from 1 to skip header
    var row = sourceData[i];
    var rowDate = row[dateCol];
    
    // Check if the row date matches our target date
    if (rowDate instanceof Date) {
      var rowFormattedDate = Utilities.formatDate(rowDate, Session.getScriptTimeZone(), 'M/d/yyyy');
      
      if (rowFormattedDate === formattedDate) {
        // Count non-empty cells in each target column
        outputOrder.forEach(function(key) {
          var colIndex = columnsToCount[key];
          var cellValue = row[colIndex];
          
          // Check if cell has data (not empty, not null, not undefined)
          if (cellValue !== '' && cellValue !== null && cellValue !== undefined) {
            counts[key]++;
          }
        });
      }
    }
  }
  
  // Write results to Daily Count sheet in the new order
  var resultRow = 3; // Start from row 3
  
  outputOrder.forEach(function(key) {
    var countCell = dailyCountSheet.getRange('B' + resultRow);
    countCell.setValue(counts[key]);
    resultRow++;
  });
  
  // Add timestamp
  dailyCountSheet.getRange('B' + (resultRow + 1)).setValue('Last updated: ' + new Date());
  
  SpreadsheetApp.getUi().alert('Daily count completed for ' + formattedDate);
}

// Function to create a custom menu
function onOpen() {
  var ui = SpreadsheetApp.getUi();
  ui.createMenu('Daily Count')
    .addItem('Run Daily Count', 'countDailyData')
    .addToUi();
}
